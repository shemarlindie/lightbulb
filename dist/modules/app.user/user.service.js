!function(e){"use strict";e.module("app.user").factory("User",["FirebaseService","$firebaseObject","$q","$state",function(e,n,t,i){var r={user:void 0,isAdmin:void 0,isAuthenticated:function(){return e.getRef().getAuth()},getProfile:function(t){if(t)return n(e.getRef().child("users/"+t));var i=e.getRef().getAuth();return i&&!this.user&&(this.user=n(e.getRef().child("users/"+i.uid))),this.user},login:function(n){var i=t(function(t,i){e.getRef().authWithPassword(n,function(e,n){e?i(e):t(n)},{remember:n.rememberMe?"default":"sessionOnly"})});return i},logout:function(){e.getRef().unauth(),this.user&&(this.user.$destroy(),this.user=void 0)},create:function(n){var i=n,o=t(function(n,t){e.getRef().createUser(i,function(o,u){if(o)t(o);else{var s={email:i.email,password:i.password,rememberMe:!0};i.uid=u.uid,delete i.password,delete i.confirm_password,e.getRef().child("users/"+i.uid).set(i,function(e){e?t(e):r.login(s).then(function(e){n(e)})["catch"](function(e){t(e)})})}})});return o},remove:function(n){var i=t(function(t,i){e.getRef().removeUser(n,function(e,n){e?i(e):t(n)})});return i},changeEmail:function(n){var i=t(function(t,i){e.getRef().changeEmail(n,function(e,n){e?i(e):t(n)})});return i},changePassword:function(n){var i=t(function(t,i){e.getRef().changeEmail(n,function(e,n){e?i(e):t(n)})});return i},resetPassword:function(n){var i=t(function(t,i){e.getRef().changeEmail(n,function(e,n){e?i(e):t(n)})});return i}},o=function(n){n?void 0===r.isAdmin&&e.getRef().child("secrets/admin").once("value",function(){r.isAdmin=!0,console.log("Logged in as admin.")},function(){r.isAdmin=!1,console.log("Logged in.")}):(r.isAdmin=void 0,console.log("Logged out."))};return e.onAuth(o),r}])}(angular);